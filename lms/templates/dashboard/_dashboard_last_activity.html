<%page args="course, progress_summaries" expression_filter="h"/>

<%!
from django.urls import reverse
from django.utils.translation import ugettext as _
from lms.djangoapps.courseware.courses import get_course_resume_url
from openedx.features.course_experience import course_home_url_name
%>

<%
    course_overview = course.course_overview
    summary = progress_summaries.get(course.course_id, {})
    nb_of_badges_earned = summary.get('nb_trophies_earned', 0)
    nb_of_badges_possible = summary.get('nb_trophies_possible', 0)
    progress = summary.get('progress', 0)
    course_url = get_course_resume_url(user, course)
    if not course_url:
        course_url = reverse(course_home_url_name(course_overview.id), args=[unicode(course_overview.id)])
%>

<li class="last-activity-item">
  <div class="course-title">
    <h2>
      <a href="${course_url}">${course_overview.display_name_with_default}</a>
    </h2>
    <span><i class="far fa-trophy"></i>  ${nb_of_badges_earned} / ${nb_of_badges_possible} badges</span>
  </div>
  <div class="progress-icon">
    <svg class="progress-ring" data-percent="${progress}">
      <defs>
        <filter id="dropshadow" x="-40%" y="-40%" width="180%" height="180%" filterUnits="userSpaceOnUse">
          <feGaussianBlur in="SourceAlpha" stdDeviation="2"/> <!-- stdDeviation is how much to blur -->
          <feOffset dx="5" dy="5" result="offsetblur"/>
          <feOffset dx="-5" dy="-5" result="offsetblur"/>
          <feMerge>
            <feMergeNode/>
            <feMergeNode in="SourceGraphic"/>
            <feMergeNode in="SourceGraphic"/>
          </feMerge>
        </filter>
      </defs>
      <circle class="progress-ring__circle-bg" r="12" cx="20" cy="19"/>
      <circle class="progress-ring__circle" r="12" cx="17" cy="20"/>
    </svg>
    <div>
      <span class="percent">${progress}%</span>
      <span class="completed">${_('Completed')}</span>
    </div>
  </div>
</li>
